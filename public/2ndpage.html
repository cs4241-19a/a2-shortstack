<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>You Final Exam Grade Calculator</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i|Montserrat:300,400,500,700"
          rel="stylesheet" type="text/css">
    <!-- Bootstrap CSS File -->
    <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <!-- Libraries CSS Files -->
    <link href="lib/ionicons/css/ionicons.min.css" rel="stylesheet" type="text/css">
    <link href="lib/magnific-popup/magnific-popup.css" rel="stylesheet" type="text/css">
    <!-- Main Stylesheet File -->
    <link href="css/style.css" rel="stylesheet" type="text/css">


    <!-- =======================================================
      Template Name: GlobalLanding
      Template URL: https://templatemag.com/globallanding-bootstrap-landing-template/
      Author: TemplateMag.com
      License: https://templatemag.com/license/
    ======================================================= -->
</head>
<body>
<!-- ********** HEADER ********** -->

<div class="intro">
    <div class="content">
        <div id="large-header" class="large-header">
            <canvas id="demo-canvas"></canvas>
            <h1 class="main-title" id="resultTitle">Result</h1>
            <div class="table-responsive text-nowrap">
                <table id="gradeTable" class="table table-small main-tagline table-hover w-auto " style=width:50%>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!--content-->
</div>
<!-- /intro -->
<!-- JavaScript Libraries -->
<script src="lib/jquery/jquery.min.js"></script>
<script src="lib/bootstrap/js/bootstrap.min.js"></script>
<script src="lib/easing/easing.js"></script>
<script src="lib/tweenlite/tweenlite.min.js"></script>
<script src="lib/tweenlite/easepack.min.js"></script>
<script src="lib/tweenlite/init.js"></script>

<script>
    /*
      function removeEntry(ref){
          var usernameRef = usersRef.child(ref);
          usernameRef.remove();
      }

      const deleteEntry = function (n){
          const rowNum={rowNum:n};
          fetch('/delete',{
              method:'POST',
              body:JSON.stringify({rowNum:n}),
          });
          fillTable();
      };*/
    window.onload = function () {
        const fillTable = function(){
            fetch('/receive')
                .then(function (response) {
                    return json = response.json();
                }).then(function (response) {
                console.log('post response: ', response);
                let DataKey = localStorage.getItem('token');
                let computedGrades = document.querySelector('#gradeTable');
                let numOfEntry = Object.keys(response);
                computedGrades.innerHTML =
                    '<thead>\n' +
                    '<tr>\n' +
                    '<th>Course Title</th>\n' +
                    '<th>Current Overall Grade</th>\n' +
                    '<th>Desired Overall Grade</th>\n' +
                    '<th>Final Exam Weight</th>\n' +
                    '<th>Final Exam Grade Required</th>\n' +
                    '<th>Current Grade Update</th>\n' +
                    '<th>Delete</th>\n' +
                    '</tr>\n' +
                    '</thead>\n';
                for (let i = 0; i < numOfEntry.length; i++){
                    const rows=numOfEntry[i];
                    let newRow='<tr>';
                    newRow+=('<td>'+(JSON.stringify(response[rows].token)).replace(/^"(.*)"$/, '$1')+'</td>');
                    newRow+=('<td>'+(JSON.stringify(response[rows].currentGrade)).replace(/^"(.*)"$/, '$1')+'</td>');
                    newRow+=('<td>'+(JSON.stringify(response[rows].desired)).replace(/^"(.*)"$/, '$1')+'</td>');
                    newRow+=('<td>'+(JSON.stringify(response[rows].finalWorth)).replace(/^"(.*)"$/, '$1')+'</td>');
                    newRow+=('<td>'+(JSON.stringify(response[rows].finalExam)).replace(/^"(.*)"$/, '$1')+'</td>');
                    newRow+=('<td><ul><li><input id="updateInput" type="number" id="desired" placeholder="Number only"/></li><li><button class="button" id=" ' + i + ' " onclick="updateEntry (' + i + ')"> âˆš </button></li></ul></td>\n');
                    newRow+=('<td><button class="button" id=" ' + i + ' " onclick="removeEntry (' + i + ')"> X </button></td>\n');
                    newRow+='</tr>';
                    computedGrades.innerHTML+=newRow;
                }
            })
        };
        fillTable();
    }
</script>


</body>

</html>