<!doctype html>
<html lang="en">
  <head>
    <title>CS4241 Assignment 2</title>
    <meta charset="utf-8">
  </head>
  <body>
    <form id = "info" action="/submit" method = "POST">
      <input type="text" name="yourname" placeholder="your name here"><br>
      <input type ="text" name="classyear" placeholder="Your class year"><br>
      <input type = "text" name="height" placeholder="Your height in inches"><br>
      <!--<button name ="submit">submit</button><br>-->
      
     <!-- <input type="text" id="delname" value="delete name"><br>
      <button onclick="myDelete()">delete</button>-->
    </form>
    <button id = "submit" class = "inputbutton" onclick = "submit()">submit</button><br><br>
    
    <form id = "delete" action = "/delete" method = "POST">
      <input type = "text" name = "delName" placeholder = "Name to delete"><br>
      
    </form>
    <button id = "deleteBtn" class = "inputbutton" onclick = "onDelete()">delete</button><br><br>
    
    <table id = "dataTable">
      <th>Name</th>
      <th>ClassYear</th>
      <th> Height in inches</th>
    </table>
  </body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  
  <script>

  function submit(  ) {
    
    console.log("Testing for name " + document.getElementById('yourname') )
    document.getElementById('info').submit()
    setTimeout(function(){
      getData()
    },1000)
    

    

    return false
  }
  
  function onDelete(){
    document.getElementById('delete').submit()
    setTimeout(function(){
      //clearTable()
      getData()
    },1000)
    
    return false
  }

  window.onload = function() {
    const button = document.querySelector( 'button' )
    button.onclick = submit
  }
    
    /*const myDelete = function( e ) {
    // prevent default form action from being carried out
    e.preventDefault()

    const deleteName = document.querySelector( '#delname' ),
          name = deleteName.value
    

    fetch( '/Ondelete', {
      method:'POST',
      name 
    })
    .then( function( response ) {
      // do something with the reponse 
      alert(name)
      console.log( response )
      
    })

    return false
  }*/
    
    
    
    function clearTable()
    {
      //$('#dataTable:not(:first)').empty()
      $.get('/data',function(response){
        response.forEach(function(item){
          document.getElementById("dataTable").deleteRow(1)
        })
        
      })
      /*for(let i=1; i < document.getElementById("dataTable").rows.length; i++)
        {
          document.getElementById("dataTable").deleteRow(i)
        }*/
      //document.getElementById("dataTable").deleteRow(1)
      console.log("Table has been reset")
    }
    
    function getData()
    {
      $.get('/data',function(response){
        //clearTable(document.getElementById("dataTable"))
        clearTable()
        response.forEach(function(item){
          console.log("item is " +item)
          $('#dataTable').append('<tr><td>' + item.name + '</td><td>' + item.year + '</td><td>' + item.inches  + '</td></tr>')
        })
      })
    }
    
    
  
    

  </script>
</html>
