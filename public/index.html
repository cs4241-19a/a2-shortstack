<!doctype html>
<html lang="en">

<head>
  <title>CS4241 Assignment 2</title>
  <meta charset="utf-8">
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <form method="post">
    <!--<form action="/form-handling" method="post">-->
    <div>
      <label for="firstnameLabel">First Name:</label>
      <input type="text" id="firstname" value="">
    </div>
    <div>
      <label for="lastnameLabel">Last Name:</label>
      <input type="text" id="lastname" value="">
    </div>
    <div>
      <label for="majorLabel">Major:</label>
      <input type="text" id="major" value="">
    </div>
    <div>
      <label for="numberLabel">Favorite Number:</label>
      <input type="text" id="number" value="">
    </div>
    <div class="button">
      <button type="submit" id="submitButton">Submit</button>
    </div>
    <div class="button">
      <button type="submit" id="databaseButton">Database</button>
    </div>
  </form>
  <p id="result" />
</body>
<script>
const getdata = function() {
  document.getElementById("result").innerHTML = "hi"
  fetch("/getdata", {
      method: "GET",
    })
    .then(function(response) {
      console.log("get response: ", response);
        document.getElementById("result").innerHTML = JSON.parse(response)
    })
}

  const submit = function(e) {
    // prevent default form action from being carried out
    e.preventDefault();

    const firstname = document.querySelector("#firstname");
    const lastname = document.querySelector("#lastname");
    const major = document.querySelector("#major");
    const number = document.querySelector("#number");

    if (!isNaN(number.value)) {
      document.getElementById("result").innerHTML =
        firstname.value + ", " + lastname.value + ", " + major.value + ", " +
        number.value;
      json = {
          firstname: firstname.value,
          lastname: lastname.value,
          major: major.value,
          number: number.value
        },
        body = JSON.stringify(json)

      fetch("/submit", {
          method: "POST",
          body
        })
        .then(function(response) {
          // do something with response
          console.log(response)
        })

      return false
    } else {
      document.getElementById("result").innerHTML = "Please enter a valid number."
    }

    return false
  }

  window.onload = function() {
    const submitButton = document.querySelector("#submitButton")
    const databaseButton = document.querySelector("#databaseButton")
    submitButton.onclick = submit
    databaseButton.onclick = getdata
  }


</script>

</html>
