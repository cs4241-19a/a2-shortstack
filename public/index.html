<!doctype html>
<html lang="en">
  <head>
    <title>CS4241 Assignment 2</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  </head>
  <body onload="occupySchedule()">
    <div class="title">
      Daily Schedule
    </div>
    <div class="board" data-board="fullboard"> 
      <div class="boardsection" data-board="day_1">
        <div class="header" day="1">
          Sunday
        </div>
        <div class="tasklist" day="1">
          
        </div>
      </div>
      <div class="boardsection" data-board="day_2">
      <div class="header" day="2">
          Monday
        </div>
        <div class="tasklist" day="2">
          
        </div>
      </div>
      <div class="boardsection" data-board="day_3">
      <div class="header" day="3">
          Tuesday
        </div>
        <div class="tasklist" day="3">
          
        </div>
      </div>      
      <div class="boardsection" data-board="day_4">
        <div class="header" day="4">
          Wednesday
        </div>
        <div class="tasklist" day="4">
          
        </div>
      </div>
      <div class="boardsection" data-board="day_5">
        <div class="header" day="5">
          Thursday
        </div>
        <div class="tasklist" day="5">
          
        </div>
      </div>
      <div class="boardsection" data-board="day_6">
        <div class="header" day="6">
          Friday
        </div>
        <div class="tasklist" day="6">
          
        </div>
      </div>
      <div class="boardsection" data-board="day_7">
        <div class="header" day="7">
          Saturday
        </div>
        <div class="tasklist" day="7">
          
        </div>
      </div>    
    </div>
    <div class="menu">
      <button id="next">
        Next Day
      </button>
      <form action="">
        <div class="menu-data">
          <span> Day: </span>
          <input type="text" id="day" value="Monday">
          <span> Task: </span>
          <input type="text" id="task" value="HW">
          <span> Time: </span>
          <input type="time" id="time" value="02:00">
        </div>

        <button id="submit">Add to Schedule</button>
      </form>
    </div>
    
  </body>
  <script type="text/javascript" src="js/scripts.js"></script>
  <script>
  const submit = function( e ) {
    // prevent default form action from being carried out
    e.preventDefault()

    const url = '/information',
          input = document.querySelector( '#response' ),
          json = { yourresponse: input.value },
          body = JSON.stringify( json ),
          answer = document.querySelector( '#answer')

    //answer.innerHTML = "hi"

    
    fetch( '/submit', {
      method:'POST',
      body
    })
    .then( function( response ) {
      // do something with the reponse 
      //text.textContent = response;
      console.log( response )
      //occupyText()
      
    
      fetch(url)
        .then(function( response ) {
          //response.json();
          answer.innerHTML = response.body

          console.log(response)
      }).then(function(data) {
        //answer.innerHTML = data
        //console.log(info)
      });
      

      
    })

    return false
  }
  
  const occupySchedule = function() {
    alert("Running");
    fetch( '/info' )
      .then( function( response ) {
        console.log( response )
        return response.json()
    })
      .then( function( myJSON ) {
        var info = myJSON.data
        var task = document.createTextNode(info[0].task)
        document.querySelector("boardsection[data_board[day='1']")
        //answer.innerHTML = info[1].value
        
      
        console.log( info[1] )
        console.log( JSON.stringify( myJSON ) )
    })
  }
  
  const addEvent = function(e) {
  e.preventDefault();
  var day = document.querySelector("#day").value
  var task = document.querySelector("#task").value
  var time = document.querySelector("#time").value
  console.log("Day: " + day + " Time: " + time + " Task: "+ task);
    
  var newEvent = {
    day : document.querySelector("#day").value,
    task : document.querySelector("#task").value,
    time : document.querySelector("#time").value,
  };
  var newEventInfo = JSON.stringify( newEvent );
  fetch('/submit',{
    method: 'POST',
    body
  }).then( function( response ) {
    document.querySelector( day ).appendChild( time + " " + task );

    document.querySelector("#day").value = '';
    document.querySelector("#task").value = '';
    document.querySelector("#time").value = '';
  }) 

  window.onload = function() {
    
    const button = document.querySelector( '#submit' )
    button.onclick = addEvent
  }
    

    
    
    
    
  }
    

  </script>
</html>
