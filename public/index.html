<!--<!doctype html>
<html lang="en">
<head>
  <title>CS4241 Assignment 2</title>
  <meta charset="utf-8">
</head>
<body>
<h1>Become a Hogwarts Student</h1>
<form action="">
  <div>
    <label for="firstName">First Name:</label>
    <input type="text" id="firstName"/>
  </div>
  <div>
    <label for="lastName">Last Name:</label>
    <input type="text" id="lastName"/>
  </div>
  <div>
    <label for="pronouns">Pronouns:</label>
    <input type="text" id="pronouns"/>
  </div>
  <div>
    <label for="house">House:</label>
    <input type="text" id="house"/>
  </div>
  <br><button>submit</button>
</form>
<br>
<h3>Students:</h3>
<table id="HogwartsStudents" style="width:100%"></table>
</body>
<script>

  const submit = function( e ) {
    // prevent default form action from being carried out
    e.preventDefault()

    const firstName = document.querySelector('#firstName'),
            lastName = document.querySelector('#lastName'),
            pronouns = document.querySelector('#pronouns'),
            house = document.querySelector('#house'),

    json = {
      'firstName': firstName.value,
      'lastName': lastName.value,
      'pronouns': pronouns.value,
      'house': house.value
    },

    body = JSON.stringify(json)

    fetch( '/submit', { //url name = /submit
      method:'POST',
      body //same as saying->body:body
    })
            .then( function( response ) {
              // response = body

              //console.log( response )
              //showData();
            })

    showData();
    return false
  }

  const deleteRow = function (rowIndex) {
    const rowData = { rowData: rowIndex};
    console.log(rowIndex);
    const body = JSON.stringify(rowData);
    fetch('/delete', {
      method: 'POST',
      body
    });
    showData();
  };

  const showData = function(){
    fetch('/cars',{
      method: 'GET'
    })
            .then( function (response){
              return response.json()
            })
            .then( function(studentList){
              console.log(studentList)

              let studentTable = document.querySelector('#HogwartsStudents');

              //setting the header at the top of the table
              studentTable.innerHTML =

                      '<tr>\n'+
                      '<th>First Name</th>\n'+
                      '<th>Last Name</th>\n'+
                      '<th>Pronouns</th>\n'+
                      '<th>House</th>\n'+
                      '<th>Delete</th>\n'+
                      '</tr>';

              for(let i = 0; i < studentList.length; i++){
                const currentStudent = studentList[i];
                let newLine = '<tr>'
                newLine+=('<td>' + currentStudent.firstName + '</td>\n');
                newLine+=('<td>' + currentStudent.lastName + '</td>\n');
                newLine+=('<td>' + currentStudent.pronouns + '</td>\n');
                newLine+=('<td>' + currentStudent.house + '</td>\n');
                newLine+=('<td><button id="' + i + '" onclick="deleteRow(' + i + ')"> X </button></td>\n');
                newLine+='</tr>';

                studentTable.innerHTML += newLine
              }


            })
  }



  window.onload = function() {
    const button = document.querySelector( 'button' )
    button.onclick = submit

  }


</script>
</html> -->

<!doctype html>
<html lang="en">
  <head>
    <title>CS4241 Assignment 2</title>
    <meta charset="utf-8">
    
    <link href="css/style.css" rel="stylesheet">
  </head>
  <body>
    <h1>Budget For Your Next Roadtrip</h1>
    <form action="">
      <div>
        <label for="name">Model:</label>
        <input type="text" id="model" value="Enter your Car Model">
      </div>
      <div>
        <label for="year">Year:</label>
        <input type="text" id="year" name="car_year" />
      </div>
      <div>
        <label for="mpg">MPG:</label>
        <input type="text" id="mpg" name="car_mpg" />
      </div>
      <div>
        <label for="distance">Trip Distance:</label>
        <input type="text" id="distance" name="trip_distance" />
      </div>
      <div>
        <label for="gas">Gas Price:</label>
        <input type="text" id="gas" name="gas_price" />
      </div>
      <br><button>submit</button>
    </form>
    <br>
    <h3>My Saved Trips</h3>
    <table id="CarData" class="display nowrap" style="width:100%">

    </table>
  </body>
  <script>
    /*window.localStorage;
    localStorage.setItem('firstvalue', model.value);*/
  const submit = function( e ) {
    // prevent default form action from being carried out
    e.preventDefault()

    const model = document.querySelector( '#model' ),
          year = document.querySelector( '#year' ),
          mpg = document.querySelector( '#mpg' ),
          distance = document.querySelector( '#distance' ),
          gas = document.querySelector( '#gas' )
    
          json = { 'model': model.value, 
                  'year': year.value,
                 'mpg': mpg.value, 
                  'tripDistance': distance.value,
                 'gasPrice': gas.value},
          body = JSON.stringify( json )

    fetch( '/submit', { //url name = /submit
      method:'POST',
      body //same as saying->body:body 
    })
    .then( function( response ) {
 
      //showData();
    })

    //window.location = "index.html";
    showData();
    return false
  }

  const deleteRow = function (rowIndex) {
    const rowData = { rowData: rowIndex};
    const carData = JSON.stringify(rowData);
    fetch('/delete', {
      method: 'POST',
      carData
    });
    showData();
  };

  const showData = function(){
    fetch('/cars',{
      method: 'GET'
    })
    .then( function (response){
        return response.json()
    })
    .then( function(theCarData){
      console.log(theCarData)

      /*let entry=document.createElement("div");
      entry.innerHTML=JSON.stringify(theCarData);
      document.body.appendChild(entry);*/

      let finalCarData = document.querySelector('#CarData');

      //setting the header at the top of the table
      finalCarData.innerHTML =

                '<tr>\n'+
                '<th>Model</th>\n'+
                '<th>Year</th>\n'+
                '<th>MPG</th>\n'+
                '<th>Trip Distance</th>\n'+
                '<th>Gas Price</th>\n'+
                '<th>Total Gallons</th>\n'+
                '<th>Total Cost</th>\n'+
                '<th>Delete</th>\n'+
                '</tr>';

      //console.log("this one: ", typeof(getFetch))
      //const newData = theCarData.data
      //console.log("hhhh,   ", data)
      //console.log("This is Data",typeof(newData))
     /*theCarData.forEach(cars => {
        let newLine = '<tr>'
        newLine+=('<td>' +cars.model+ '</td>')
        newLine+=('<td>' +cars.year+ '</td>')
        newLine+=('<td>' +cars.mpg+ '</td>')
        newLine+=('<td>' +cars.tripDistance+ '</td>')
        newLine+=('<td>' +cars.gasPrice+ '</td>')
        newLine+=('<td>' +cars.totalGallons+ '</td>')
        newLine+=('<td>' +cars.totalCost+ '</td>')
        newLine+=('<td>' + '<button id="delete"> X </button>' + '</td>')
        newLine+='</tr>'
        

        finalCarData.innerHTML += newLine

      })*/

      for(let i = 0; i < theCarData.length; i++){
        const cars = theCarData[i];
        let newLine = '<tr>'
        newLine+=('<td>' +cars.model+ '</td>');
        newLine+=('<td>' +cars.year+ '</td>');
        newLine+=('<td>' +cars.mpg+ '</td>');
        newLine+=('<td>' +cars.tripDistance+' miles'+ '</td>');
        newLine+=('<td>' +'$'+cars.gasPrice+ '</td>');
        newLine+=('<td>' +cars.totalGallons+ '</td>');
        newLine+=('<td>' +'$'+cars.totalCost+ '</td>');
        newLine+=('<td><button id="' + i + '" onclick="deleteRow(' + i + ')"> X </button></td>\n');
        //newLine+=('<td>' + '<button id="delete-${i}"> X </button>' + '</td>');
        //newLine+=('<td>'+ "<button id='delete-"+${i}+"' type='button' onclick='deleteRow(" + '"' + + ${i} + '"' + ")' >X</button>" +'</td>');
        //newLine+=('<td>' + '<button onclick="deleteRow(${i})" id="delete-${i}"> X </button>' + '</td>');
        newLine+='</tr>';

        finalCarData.innerHTML += newLine
      }


    })
  }

const dbData = function(){
      fetch( '/getData')
      .then( function( response ) {
        return json = response.json();
        })
      .then(function (response){
            console.log( 'post response: ', response );
            var n=localStorage.getItem('firstvalue');
            document.getElementById('emptyfield').innerText=JSON.stringify(response[n].model)
        });
}


  window.onload = function() {
    const button = document.querySelector( 'button' )
    button.onclick = submit

    //dbData();

  }

  </script>
</html> 

<!-- Notes

json.stringify() converts a string to a JSON object
json.parse() converts a JSON object to a string

Values inside form that User submits on UI will be JSON object and then gets sent to server.js to be manipulated. 

<button id=“submitButton”>Submit</button>  
document.querySelector(‘#submitButton’)

button.addEventListener(‘click”, submit) -> can add multiple listeners or remove them 

can use cookies to send data back and forth 

can use createElement to form your data (ie add in a table)
-->


