<!doctype html>
<html lang="en">
  <head>
    <title>CS4241 Assignment 2</title>
    <meta charset="utf-8">
    <link rel = "stylesheet"
   type = "text/css"
   href = "public/css/style.css" />
  </head>
  <style>
    
    body {background: rgb(192,192,192);}
    
    
    
    .input{
      
      margin-right:1%;
      float: left;
      
    }
    
    table, th{  border: 1px solid black;
    text-align: center;
      margin: 25% auto;
    }
    
    #delete{
      float: right;
      margin-left: 5%;
      
    }
    #deleteBtn, #submit{
      width:100%
    }
    
  </style>
  <body>
    <div class="input">
      
    
    <form id = "info" action="/submit" method = "POST">
      <input type="text" name="yourname" placeholder="your name here"><br>
      <input type ="text" name="classyear" placeholder="Your class year"><br>
      <input type = "text" name="height" placeholder="Your height in inches"><br>
      
    </form>
    <button id = "submit" class = "inputbutton" onclick = "submit()">submit</button><br><br>
    </div>
    
    
    <form id = "delete" action = "/delete" method = "POST">
      <input type = "text" name = "delName" placeholder = "Name to delete"><br>
      <button id = "deleteBtn" class = "inputbutton" onclick = "onDelete()">delete</button><br><br>
    </form>
    
    
    <table id = "dataTable">
      <th>Name</th>
      <th>ClassYear</th>
      <th> Height in inches</th>
      <th> Height in centimeters</th>
    </table>
  </body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  
  <script>

  function submit(  ) {
    
    console.log("Testing for name " + document.getElementById('yourname') )
    document.getElementById('info').submit()
    setTimeout(function(){
      clearTable()
      getData()
    },1000)
    

    

    return false
  }
  
  function onDelete(){
    document.getElementById('delete').submit()
    setTimeout(function(){
      clearTable()
      document.getElementById("dataTable").deleteRow(1)
      getData()
    },1000)
    
    return false
  }

 
    
    
    
    function clearTable()
    {
      
      $.get('/data',function(response){
        
        response.forEach(function(item){
          console.log("cleariunug list" )
          document.getElementById("dataTable").deleteRow(1)
        })
        
      })
     
      console.log("Table has been reset")
    }
    
    function getData()
    {
      $.get('/data',function(response){
       
          
          response.forEach(function(item){
          console.log("item is " +item)
          $('#dataTable').append('<tr><td>' + item.name + '</td><td>' + item.year + '</td><td>' + item.inches  + '</td><td>' + item.cm + '</td></tr>')
          console.log("wrote " + item.name)
        })
          
      
        
      })
      console.log("Done writing")
    }
    
    
  
    

  </script>
</html>
